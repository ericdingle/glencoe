<link rel="import" href="/bower_components/iron-icons/av-icons.html">
<link rel="import" href="/bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/src/court-app.html">
<link rel="import" href="/src/court-ui.html">
<dom-module id="court-page">
  <template>
    <style>
    #display {
      display: flex;
      flex-direction: column;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    #time {
      font-size: 30px;
      margin: auto;
    }
    .green {color: green;}
    .red {color: red;}
    paper-icon-button {
      background-color: #000;
      border-radius: 50%;
      color: #FFF;
      margin: 1px;
    }
    </style>
    <court-app id="courtApp"
        difficulty="[[difficulty]]" interval-length="[[intervalLength]]"
        rest-length="[[restLength]]" repetitions="[[repetitions]]"
        time="{{time}}" index="{{index}}" state="{{state}}" active="{{active}}">
    </court-app>
    <div id="display">
      <div id="time" class$="[[_formatClass(active)]]">[[_formatTime(time)]]</div>
      <div>
        <paper-icon-button icon="[[_formatIcon(state)]]" mini on-tap="pause"></paper-icon-button>
        <paper-icon-button icon="av:stop" mini on-tap="stop"></paper-icon-button>
      </div>
    </div>
    <court-ui index="[[index]]"></court-ui>
  </template>
  <script>
  Polymer({
    is: 'court-page',

    play: function() {
      this.$.courtApp.play();
    },
    pause: function() {
      this.$.courtApp.pause();
    },
    stop: function() {
      this.$.courtApp.stop();
      this.fire('stop');
    },

    _formatClass: function(active) {
      return active ? 'green' : 'red';
    },
    _formatTime: function(time) {
      var minutes = "0" + Math.round(time / 60);
      var seconds = "0" + (time % 60);
      return minutes.slice(-2) + ':' + seconds.slice(-2);
    },
    _formatIcon: function(state) {
      return state == 'paused' ? 'av:play-arrow' : 'av:pause';
    }
  });
  </script>
</dom-module>
